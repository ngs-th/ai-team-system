# SOP: ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Task ‡πÉ‡∏´‡∏°‡πà (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô + Agent)

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ task ‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞ workflow ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á (auto-assign, spawn, review, dashboard, sprint sync)

## ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á SOP ‡∏ô‡∏µ‡πâ

- Task ‡∏ï‡πâ‡∏≠‡∏á ‚Äú‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‚Äù ‡πÑ‡∏°‡πà‡∏Å‡∏≥‡∏Å‡∏ß‡∏° ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ
- Agent ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô repo/working_dir ‡∏ñ‡∏π‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏°‡∏≠
- ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏Ñ‡∏ô (‡πÄ‡∏ä‡πà‡∏ô API key ‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á) ‡∏ï‡πâ‡∏≠‡∏á ‚Äú‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏≠‚Äù ‡πÑ‡∏°‡πà‡∏ß‡∏ô‡∏´‡∏¢‡∏¥‡∏ö‡πÑ‡∏õ‡∏ó‡∏≥
- Reviewer ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡πä‡∏Å AC ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô approve

## ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á Task (Checklist)

- ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤ task ‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÑ‡∏´‡∏ô (‡∏´‡πâ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á)
- ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô `working_dir` ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà agent ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á)
- ‡∏ñ‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏°‡∏≤‡∏à‡∏≤‡∏Å story ‡∏Ç‡∏≠‡∏á Nurse AI ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå story ‡∏Å‡πà‡∏≠‡∏ô:
  - `/Users/ngs/Herd/nurse-ai/_bmad-output/implementation-artifacts/sprint-status.yaml`
  - `/Users/ngs/Herd/nurse-ai/_bmad-output/implementation-artifacts/stories/*.md`

## ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏ä‡∏∑‡πà‡∏≠ Task (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å)

‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å story ‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô title ‡∏î‡πâ‡∏ß‡∏¢ `Story ID:` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ `sprint_status_sync.py` sync ‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
- `6-3-line-notification: ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏ú‡πà‡∏≤‡∏ô Line OA`
- `7-2-patient-stats-fairness: ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ‡πÅ‡∏•‡∏∞ Fairness ‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á`

## ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà (MANDATORY)

‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô workflow ‡∏à‡∏∞‡∏û‡∏±‡∏á:

- `project_id`
- `working_dir`
- `expected_outcome`
- `prerequisites` (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô markdown checklist)
- `acceptance_criteria` (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô markdown checklist)

## HUMAN-only prerequisites (‡∏Å‡∏±‡∏ô agent ‡∏ï‡∏¥‡πä‡∏Å‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏≠‡∏á)

‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡πÑ‡∏´‡∏ô ‚Äú‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏à‡∏£‡∏¥‡∏á‚Äù ‡πÄ‡∏ä‡πà‡∏ô token/secret ‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô item ‡πÉ‡∏´‡πâ‡∏°‡∏µ marker:

- `HUMAN:` ‡∏´‡∏£‡∏∑‡∏≠ `@human` ‡∏´‡∏£‡∏∑‡∏≠ `üîí`

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
- `- [ ] HUMAN: ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö LINE OA Channel Access Token/Secret (‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á) @human`

‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤:
- Agent ‡∏´‡πâ‡∏≤‡∏°‡∏ï‡∏¥‡πä‡∏Å HUMAN-only prerequisites
- ‡∏Ñ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡πä‡∏Å‡∏î‡πâ‡∏ß‡∏¢ `--actor human`

```bash
python3 team_db.py task check <task_id> --field prerequisites --index <n> --done --actor human
```

‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô `info_needed` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏ô‡∏´‡∏¢‡∏¥‡∏ö‡πÑ‡∏õ‡∏ó‡∏≥:

```bash
python3 team_db.py task info-needed <task_id> "‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ <‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î> ‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ/‡∏ó‡∏µ‡∏°"
```

## ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Task (Template)

```bash
python3 team_db.py task create "<TITLE>" \
  --project <PROJ-ID> \
  --working-dir </absolute/path/to/repo> \
  --desc "<‡∏ö‡∏£‡∏¥‡∏ö‡∏ó + ‡∏•‡∏¥‡∏á‡∏Å‡πå/‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á>" \
  --priority <critical|high|normal|low> \
  --expected-outcome "<‡∏ô‡∏¥‡∏¢‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ>" \
  --prerequisites "- [ ] ...\n- [ ] ..." \
  --acceptance "- [ ] AC1: ...\n- [ ] AC2: ..."
```

## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (Nurse AI ‡∏à‡∏≤‡∏Å story)

```bash
python3 team_db.py task create "6-3-line-notification: ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏ú‡πà‡∏≤‡∏ô Line OA" \
  --project PROJ-001 \
  --working-dir /Users/ngs/Herd/nurse-ai \
  --desc "Story file: /Users/ngs/Herd/nurse-ai/_bmad-output/implementation-artifacts/stories/6-3-line-notification.md" \
  --priority high \
  --expected-outcome "‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏ú‡πà‡∏≤‡∏ô Line OA ‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á + ‡∏°‡∏µ log + ‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÄ‡∏ß‡∏•‡∏≤" \
  --prerequisites "- [ ] HUMAN: ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö LINE OA Channel Access Token/Secret (‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á) @human\n- [ ] ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô working_dir = /Users/ngs/Herd/nurse-ai\n- [ ] ‡∏≠‡πà‡∏≤‡∏ô story ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö (path ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô)\n- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Services/DB changes ‡πÅ‡∏•‡∏∞ dependencies ‡πÉ‡∏ô story" \
  --acceptance "- [ ] AC1: ‡∏™‡πà‡∏á Line Push Message ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô\n- [ ] AC2: ‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 1 ‡∏ô‡∏≤‡∏ó‡∏µ (NFR)\n- [ ] AC3: ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô\n- [ ] AC4: ‡∏°‡∏µ table ‡πÄ‡∏Å‡πá‡∏ö log ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á\n- [ ] AC5: ‡∏°‡∏µ warning ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ú‡∏π‡∏Å Line\n- [ ] AC6: ‡∏°‡∏µ retry ‡∏ú‡πà‡∏≤‡∏ô queue ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Line API ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß\n- [ ] AC7: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ credentials ‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á (HUMAN-only prerequisite ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡πä‡∏Å‡∏Å‡πà‡∏≠‡∏ô)"
```

## ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Task ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ï‡πà‡∏≠ (Workflow)

1. Assign ‡πÉ‡∏´‡πâ agent (‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ auto-assign)
```bash
python3 team_db.py task assign <task_id> <agent_id>
```

2. ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö spawn + auto-start ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡πâ‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÑ‡∏õ Doing
```bash
python3 spawn_manager_fixed.py
```

3. ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡∏ñ‡πâ‡∏≤ agent ‡∏û‡∏ö prerequisite ‚Äú‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‚Äù
- ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ `task requeue` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö `todo` ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà blocked)
```bash
python3 team_db.py task requeue <task_id> --reason "Prerequisite not met: <‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏ß‡πà‡∏≤‡∏Ç‡∏≤‡∏î‡∏≠‡∏∞‡πÑ‡∏£/‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ï‡πà‡∏≠>"
```

4. ‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏î ‚Äú‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‚Äù ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ `info_needed` (‡∏Å‡∏±‡∏ô‡∏ß‡∏ô)
```bash
python3 team_db.py task info-needed <task_id> "‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ <‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏ï‡πà‡∏≠"
```

## ‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Reviewer (‡∏´‡∏•‡∏±‡∏á task ‡πÑ‡∏õ review)

- Reviewer ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô/‡∏ï‡∏£‡∏ß‡∏à‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏£‡∏¥‡∏á ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡πä‡∏Å acceptance criteria ‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô approve
- ‡∏ñ‡πâ‡∏≤ prerequisites ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö:
  - ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô prereq ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ: return ‡πÑ‡∏õ `todo` ‡∏û‡∏£‡πâ‡∏≠‡∏° feedback ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
  - ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô HUMAN-only: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô `info_needed`

## Anti-pattern ‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≤‡∏°‡∏ó‡∏≥

- ‡∏™‡∏£‡πâ‡∏≤‡∏á task ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà `working_dir`
- ‡πÉ‡∏ä‡πâ title ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Story ID ‡∏ó‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏à‡∏≤‡∏Å story (‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ sprint sync ‡∏û‡∏±‡∏á)
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô prerequisites/AC ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà checklist (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô `- [ ] ...`)
- ‡πÉ‡∏´‡πâ agent ‡∏ï‡∏¥‡πä‡∏Å prerequisite ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô HUMAN-only ‡πÄ‡∏≠‡∏á

